## 빌더 패턴

빌더 패턴은 생성자에 들어갈 매개변수가 많든 적든 차례차례 매개 변수를 받아들이고, 사용자가 요청한 모든 매개 변수를 받은 뒤 이 변수들을 통합해서 한번에 사용한다.

### 매개변수는 언제 사용하면 되는걸까?

~~~java
public class Pet {

    private final String petName;
    private final String ownerName;
    private final String address;
    private final String telephone;
    private final Date dateOfBirth;		//선택 사항
    private final String emailAddress;	//선택 사항
    
}
~~~

유효한 Pet 객체를 만들기 위해서는

- 모든 매개변수를 갖고 있는 생성자
- 필수 + 선택사항 각각을 갖고 있는 생성자(2개)
- 빈 생성자

총 4개의 생성자가 필요하다. 또한 생성자의 매개변수 순서도 정확히 일치해야한다.

그러나 만약, 여기에 더 많은 필드가 추가되면 관리하기에는 더욱 어려워진다.



이런 문제를 해결하기 위해서 **필드에 final을 제거하고 Pet 객체에 Setter 메서드를 사용한다.**

~~~java 
final Pet p = new Pet();
p.setEmailAddress("myhs2002@gmail.com");
~~~

단, Setter를 사용해서 객체를 생성할 때는 필수 값이 모두 들어가야만 우리가 필요로 하는 객체가 되므로, **animal, perName, ownerName, address, telephone 필드는 꼭 setter를 통해 값이 입력되어야 한다.**



이것도 참 번거로운 거 같다.. 사용자가 일일히 다 체크를 해야하다니.. 그래서 등장한 것이 **빌더 패턴**이다.



### 빌더 패턴

**빌더 패턴의 특징은 다음과 같다**

- 불필요한 생성자를 만들지 않고 객체를 만든다.
- 데이터의 순서에 상관없이 객체를 만들어낸다.
- 사용자가 봤을 때 명시적이고 이해가 가능하다.

~~~java
public class Pet {
    
    public static class Builder {

        private String petName;
        private String ownerName;
        private String address;
        private String telephone;
        private Date dateOfBirth;
        private String emailAddress;

        public Builder withPetName(final String petName) {
            this.petName = petName;
            return this;
        }

        public Builder withOwnerName(final String ownerName) {
            this.ownerName = ownerName;
            return this;
        }

        public Builder withAddress(final String address) {
            this.address = address;
            return this;
        }

        public Builder withTelephone(final String telephone) {
            this.telephone = telephone;
            return this;
        }

        public Builder withDateOfBirth(final Date dateOfBirth) {
            this.dateOfBirth = dateOfBirth;
            return this;
        }

        public Builder withEmailAddress(final String emailAddress) {
            this.emailAddress = emailAddress;
            return this;
        }
        
        public Pet build() {
            if (petName == null ||
                    ownerName == null ||
                    address == null ||
                    telephone == null) {
                throw new IllegalStateException("Cannot create pet : 필수 값 없음");
            }

            return new Pet(
                    petName,
                    ownerName,
                    address,
                    telephone,
                    dateOfBirth,
                    emailAddress);
        }
    }

    private final String petName;
    private final String ownerName;
    private final String address;
    private final String telephone;
    private final Date dateOfBirth;
    private final String emailAddress;
    
    private Pet(final String petName,
                final String ownerName,
                final String address,
                final String telephone,
                final Date dateOfBirth,
                final String emailAddress) {
        this.petName = petName;
        this.ownerName = ownerName;
        this.address = address;
        this.telephone = telephone;
        this.dateOfBirth = dateOfBirth;
        this.emailAddress = emailAddress;
    }
}
~~~

**빌더 패턴을 구성하는데,**

1. Pet 객체 내에 Builder 객체를 만든다.
2. Builder 객체는 각 메소드의 return 타입을 모두 Builder 타입으로 하여 체인화 방식으로 매개변수를 선언할 수 있게끔 한 것이다.
3. 그리고 build() 메소드에서 필수 값이 잘 들어가있는 지 확인 후 이상 없으면 정상적으로 Pet 객체를 생성하게끔 구성한 패턴이다.
4. Pet 객체는 단순히 각 필드값과 생성자만 있되, 모두 private으로 제한하여 빌더 패턴을 통해서만 생성할 수 있도록 한다.



**실행해보자**

~~~java
public class BuildPtMain {
    public static void main (String [] args) {
        BuildPtPet.Builder builder = new BuildPtPet.Builder();

        BuildPtPet pet = builder
                .withPetName("cat")
                .withOwnerName("mesung")
                .withTelephone("112")
                .withAddress("suwon")
                .withDateOfBirth(Calendar.getInstance().getTime())
                .withEmailAddress("myhs2002")
                .build();

        System.out.println(pet.toString());

    }
}
~~~

![image](https://user-images.githubusercontent.com/40616436/73267881-3e019f80-421d-11ea-99d1-a3dd6c0f1d01.png)

정상적으로 객체가 생성된 것을 확인할 수 있다.

만약 필수 값이 안 들어가 있다면,

![image](https://user-images.githubusercontent.com/40616436/73268332-2840aa00-421e-11ea-8b31-3d2742c9ad42.png)

우리가 Exception으로 설정한 IllegalStateExcpetion과 메시지를 확인할 수 있다.